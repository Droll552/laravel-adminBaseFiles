"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[31],{4031:(t,e,i)=>{i.r(e),i.d(e,{default:()=>r});function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const o={name:"media-library",props:{mediaRoute:String,inputName:String,multiple:Boolean,isLibrary:Boolean,isGrouped:Boolean,uppyOptions:Object,acceptedTypes:String|Array|null},data:function(){return{isShown:!1,input:{previewClass:".fileinput-preview",wrapperClass:".fileinput",buttonsClass:".buttons"},isMediaLibrary:this.isLibrary,choices:[],pagination:[],media:[],searchText:""}},mounted:function(){var t=this;this.makeAjax(),document.addEventListener("uppy-complete",(function(e){return t.uploadFinished(e)}))},watch:{isShown:function(t,e){if(t){var i=document.createElement("div");return i.classList.add("modal-backdrop","show"),void document.body.appendChild(i)}this.searchText="",this.makeAjax(),document.querySelector(".modal-backdrop").remove()}},methods:{uploadFinished:function(t){var e=this;this.makeAjax(),setTimeout((function(){return e.isMediaLibrary=!0}),1500)},isPicked:function(t){return this.choices.includes(t.id)},pickAndClose:function(t){this.chooseMedium(t),this.pick()},pick:function(){var t=this;if(this.multiple){var e=this.$el.closest(".js-collectionContainer").querySelector(".js-addToCollection");this.choices.forEach((function(i){e.click();var s=document.querySelectorAll('input[name^="'+t.inputName+'"]'),a=Array.from(s).pop();t.fillHtml(a,t.media.find((function(t){return t.id===i})))}))}else this.choices.forEach((function(e){var i=document.querySelector('input[name="'+t.inputName+'"]');t.fillHtml(i,t.media.find((function(t){return t.id===e})))}));this.choices=[],this.isShown=!1},fillHtml:function(t,e){var i=t.parentNode.querySelector(this.input.previewClass);if(i){var s=i.dataset.imgclass;i.innerHTML='<img src="'+e.thumb_url+'" class="'+s+'"/>'}var a=t.parentNode.querySelector(this.input.buttonsClass);if(a.querySelector(".js-show"))a.querySelector(".js-show").href=e.url;else{var n=this.isGrouped?"":"mb-1 ml-1";a.insertAdjacentHTML("beforeend",'<a class="'.concat(n,' js-show btn btn-secondary btn-sm align-middle" role="button" href="').concat(e.url,'" target="_blank"><i class="fas fa-eye"></i></a>'))}document.dispatchEvent(new CustomEvent("baseAdmin.fileInput.changed",{bubbles:!0,cancelable:!1,detail:{addInputVal:e.id,input:t,filled:!0,name:"".concat(e.filename,".").concat(e.extension)}}))},chooseMedium:function(t){var e=t.id;if(this.isPicked(t)){var i=this.choices.indexOf(e);this.choices.splice(i,1)}else this.multiple||(this.choices=[]),this.choices.push(e)},search:function(){var t=this;setTimeout((function(){t.makeAjax(null,{keyword:t.searchText})}),100)},makeAjax:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this;t=t||this.mediaRoute;var s=Object.assign({only_data:!0,num_of_items:10,extra_filters:a({the_file_exists:!0},this.acceptedTypes?{aggregate_type:this.acceptedTypes}:{})},e);BaseAdmin.makeAjax(t,"GET",s,0,(function(t,e){i.media=t.records.data,i.pagination=t.records.links}))}}};const r=(0,i(1900).Z)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-inline-block"},[i("button",{class:["btn btn-outline-primary btn-sm  ml-auto",{"mb-1":!1===t.isGrouped}],attrs:{type:"button"},on:{click:function(e){t.isShown=!0}}},[t.isMediaLibrary?i("span",{staticClass:"text-muted"},[i("i",{staticClass:"fas fa-photo-video"})]):t._e(),t._v(" "),t.isMediaLibrary?t._e():i("span",{staticClass:"text-muted"},[i("i",{staticClass:"fas fa-upload"})])]),t._v(" "),i("div",{class:["modal",{show:t.isShown},{"d-block":t.isShown}],attrs:{tabindex:"-1",role:"dialog","aria-labelledby":"...","aria-hidden":"true"},on:{click:function(e){t.isShown=!1}}},[i("div",{staticClass:"modal-dialog modal-dialog-centered modal-xl modal-dialog-scrollable",attrs:{role:"document"},on:{click:function(t){t.stopPropagation()}}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[i("div",{staticClass:"modal-title h5"},[t.isMediaLibrary?i("span",{staticClass:"text-muted"},[t._v("\n                            Media Library\n                        ")]):i("span",{staticClass:"text-muted"},[t._v("\n                           Upload File/s\n                        ")]),t._v(" "),i("button",{staticClass:"btn btn-outline-info ml-2 px-3",attrs:{type:"button",disabled:t.isMediaLibrary,title:"Media Library"},on:{click:function(e){t.isMediaLibrary=!0}}},[i("i",{staticClass:"fas fa-photo-video"})]),t._v(" "),i("button",{staticClass:"btn btn-outline-info ml-2 px-3",attrs:{type:"button",disabled:!t.isMediaLibrary,title:"Upload File/s"},on:{click:function(e){t.isMediaLibrary=!1}}},[i("i",{staticClass:"fas fa-upload"})])]),t._v(" "),i("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){t.isShown=!1}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("Ã—")])])]),t._v(" "),i("div",{staticClass:"modal-body"},[i("uppy",{directives:[{name:"show",rawName:"v-show",value:!0!==t.isMediaLibrary,expression:"isMediaLibrary!==true"}],class:["justify-content-center",{"d-flex":!t.isMediaLibrary}],attrs:{options:this.uppyOptions,"is-shown":!0!==t.isMediaLibrary}},[t._v("\n                            >\n                        ")]),t._v(" "),i("div",{staticClass:"mx-n2 mx-md-2"},[t.isMediaLibrary?i("div",{staticClass:"card"},[i("div",{staticClass:"card-body p-0"},[i("div",{staticClass:"p-3 "},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchText,expression:"searchText",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{placeholder:"Search..."},domProps:{value:t.searchText},on:{keyup:t.search,input:function(e){e.target.composing||(t.searchText=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"row row-cols-xl-6 row-cols-lg-4 row-cols-md-3 row-cols-2  "},t._l(t.media,(function(e){return i("div",{key:e.id,staticClass:"col text-center mb-2",attrs:{id:e.id}},[i("div",{class:["mouse-pointer py-1",{"border-primary":t.isPicked(e)}],staticStyle:{border:"2px solid transparent"},on:{dblclick:function(i){return t.pickAndClose(e)},click:function(i){return t.chooseMedium(e)}}},[i("div",{domProps:{innerHTML:t._s(e.thumb_html)}}),t._v(" "),i("div",{staticClass:"small text-muted",domProps:{innerHTML:t._s(e.title)}})])])})),0)]),t._v(" "),i("div",{staticClass:"p-2"},[i("ul",{staticClass:"pagination pagination-sm justify-content-end m-0"},t._l(t.pagination,(function(e){return i("li",{class:["page-item",{active:e.active},{disabled:null===e.url}]},[e.active?i("span",{staticClass:"page-link",domProps:{innerHTML:t._s(e.label)}}):i("a",{staticClass:"page-link",attrs:{href:e.url},domProps:{innerHTML:t._s(e.label)},on:{click:function(i){return i.preventDefault(),t.makeAjax(e.url)}}})])})),0)])])]):t._e()])],1),t._v(" "),i("div",{staticClass:"modal-footer"},[t.choices.length>0&&t.isMediaLibrary?i("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:t.pick}},[t._v("\n                            Pick Selected\n                        ")]):t._e(),t._v(" "),i("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.isShown=!1}}},[t._v("Close")])])])])])])])}),[],!1,null,null,null).exports},1900:(t,e,i)=>{function s(t,e,i,s,a,n,o,r){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=i,l._compiled=!0),s&&(l.functional=!0),n&&(l._scopeId="data-v-"+n),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},l._ssrRegister=c):a&&(c=r?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(t,e){return c.call(e),d(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:l}}i.d(e,{Z:()=>s})}}]);