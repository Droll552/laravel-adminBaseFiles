"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[593],{4593:(r,e,t)=>{t.r(e),t.d(e,{ajaxify:()=>i,ajaxifyFormOnModal:()=>s,ajaxifyDynamicFormOnModal:()=>a});var n=new Map,o=function(r,e){var t={group:"form-group",groupError:"has-error",inputError:"is-invalid",helpBlock:"help-block",invalidHelpBlock:["invalid-feedback","d-block"]},n=this;this.$form=r,n.errors=null,this.setErrors=function(r){return n.errors=r,this};var o=function(){return n.errors?n.errors:(console.warn("you have to pass the validation errors first"),{})};this.appendFormErrors=function(){return n.clearErrors(),e.each(o(),(function(r,e){var o=n.$form.find('[name="'+r+'"]');o.parents("."+t.group).addClass(t.groupError).append(i(e)),o.addClass(t.inputError)})),this},this.clearErrors=function(){return r.find("."+t.group).each((function(r,n){e(this).removeClass(t.groupError).find("."+t.invalidHelpBlock[0]).remove(),e(this).find("."+t.inputError).removeClass(t.inputError)})),this};var i=function(r){return Array.isArray(r)&&(r=r[0]),'<p class="'+t.invalidHelpBlock.join(" ")+'">'+r+"</p>"};return this.getErrorsAsText=function(){var r="";return e.each(o(),(function(e,t){r+='<div data-input="'+e+'">'+t+"</div>"})),r},this},i=function(r){if(this.$form=$(r),!this.$form.length)return console.error('"ajaxifyForm" --\x3e NO VALID SELECTOR'),!1;if(n.has(this.$form.get(0)))return n.get(this.$form.get(0));var e=this;this.form=r,this.id=$(r).attr("id"),this._callback=null,this.errorsObj=null,this.spinnerId="formSpinner_"+jsHelper.uuid();var t=function(){$(e.form).off("submit.ajaxify")};t(),this.onSubmit=function(r){"function"==typeof r&&(e._callback=r)},$(e.form).on("submit.ajaxify",(function(r,t){if(r.preventDefault(),!e.$form.hasClass("submitting")){e.$form.addClass("submitting"),e.$form.prepend(s()),$("#"+e.spinnerId).fadeIn();var n=i(this);"function"==typeof e._callback&&e._callback(e,n)}}));var i=function(r){var t=new FormData(r);return $.ajax({method:r.method,processData:!1,cache:!1,contentType:!1,url:r.action,data:t,dataType:"json"}).fail((function(r){console.log(r);var t=r.statusText+"  Error Code: "+r.status;r.responseJSON&&(e.errorsObj=new o(e.$form,$).setErrors(r.responseJSON.errors),e.errorsObj.appendFormErrors(),t=e.errorsObj.getErrorsAsText()||r.responseJSON.message||t),l({title:"Oups...!",text:t,icon:"error"})})).always((function(){e.$form.removeClass("submitting"),$("#"+e.spinnerId).remove()}))};this.clearInputs=function(){return e.$form.trigger("reset"),e},this.destroy=function(){t(),n.delete(this.$form.get(0))};var s=function(){return'<div id="'+e.spinnerId+'" class="spinnerWrapper position-absolute d-flex justify-content-center align-items-center" style="top: 0;bottom: 0;right: 0;left: 0; background:#0000001c; z-index: 9999; display: none">    <i class="fas fa-spinner fa-pulse fa-4x"></i></div>'};return n.set(this.$form.get(0),e),e},s=function(r,e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if($(r).length&&$(e).length){var o=new i(r);$(e).on("hide.bs.modal",(function(r){o.clearInputs(),n&&o.destroy(),o.errorsObj&&o.errorsObj.clearErrors()})),o.onSubmit((function(r,n){n.done((function(n){r.clearInputs(),l({title:n.msg.title,text:n.msg.msg,icon:"success"}),$(e).modal("hide"),window.BaseAdmin.ajaxLoadWrappers(t)}))}))}else console.error({modalSelector:e,formSelector:r})},a=function(r,e,t,n){$(document).on("click",r,(function(r){var o=$(t),i=$(this);$.getJSON(i.data("url"),(function(r){var i=r.extraValues.formRendered;o.find(".modal-body").html(i),BaseAdmin.triggerAjaxLoadEvent(o.get(0)),o.modal("show"),BaseAdmin.forms.ajaxifyFormOnModal(e,t,n,!0)}))}))},l=function(r){t.e(455).then(t.t.bind(t,2746,23)).then((function(e){e.default.fire({title:r.title,html:r.text,timer:1500,icon:r.icon,timerProgressBar:!0})}))}}}]);