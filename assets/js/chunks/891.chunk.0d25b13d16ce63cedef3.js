(self.webpackChunk=self.webpackChunk||[]).push([[891],{2891:(r,t,e)=>{"use strict";e.r(t),e.d(t,{ajaxify:()=>i,ajaxifyFormOnModal:()=>s});var n=[],o=function(r){var t={group:"form-group",groupError:"has-error",inputError:"is-invalid",helpBlock:"help-block",invalidHelpBlock:["invalid-feedback","d-block"]},e=this;this.$form=r,e.errors=null,this.setErrors=function(r){return e.errors=r,this};var n=function(){return e.errors?e.errors:(console.warn("you have to pass the validation errors first"),{})};this.appendFormErrors=function(){return e.clearErrors(),$.each(n(),(function(r,n){var i=e.$form.find('[name="'+r+'"]');i.parents("."+t.group).addClass(t.groupError).append(o(n)),i.addClass(t.inputError)})),this},this.clearErrors=function(){return r.find("."+t.group).each((function(r,e){$(this).removeClass(t.groupError).find("."+t.invalidHelpBlock[0]).remove(),$(this).find("."+t.inputError).removeClass(t.inputError)})),this};var o=function(r){return Array.isArray(r)&&(r=r[0]),'<p class="'+t.invalidHelpBlock.join(" ")+'">'+r+"</p>"};return this.getErrorsAsText=function(){var r="";return $.each(n(),(function(t,e){r+='<div data-input="'+t+'">'+e+"</div>"})),r},this},i=function(r){if(n[r])return n[r];if(this.$form=$(r),!this.$form.length)return console.error('"ajaxifyForm" --\x3e NO VALID SELECTOR'),!1;var t=this;this.form=r,this.$form=$(r),this.id=$(r).attr("id"),this._callback=null,this.errorsObj=null,this.spinnerId="formSpinner_"+jsHelper.uuid();var e=function(){$(t.form).off("submit.ajaxify")};e(),this.onSubmit=function(r){"function"==typeof r&&(t._callback=r)},$(t.form).on("submit.ajaxify",(function(r,e){if(r.preventDefault(),!t.$form.hasClass("submitting")){t.$form.addClass("submitting"),t.$form.prepend(s()),$("#"+t.spinnerId).fadeIn();var n=i(this);"function"==typeof t._callback&&t._callback(t,n)}}));var i=function(r){var e=new FormData(r);return $.ajax({method:r.method,processData:!1,cache:!1,contentType:!1,url:r.action,data:e,dataType:"json"}).fail((function(r){console.log(r);var e=r.statusText+"  Error Code: "+r.status;r.responseJSON&&(t.errorsObj=new o(t.$form).setErrors(r.responseJSON.errors),t.errorsObj.appendFormErrors(),e=t.errorsObj.getErrorsAsText()||r.responseJSON.message||e),a({title:"Oups...!",text:e,icon:"error"})})).always((function(){t.$form.removeClass("submitting"),$("#"+t.spinnerId).remove()}))};this.clearInputs=function(){return t.$form.trigger("reset"),t},this.destroy=function(){e(),delete n[t.form]};var s=function(){return'<div id="'+t.spinnerId+'" class="spinnerWrapper position-absolute d-flex justify-content-center align-items-center" style="top: 0;bottom: 0;right: 0;left: 0; background:#0000001c; z-index: 9999; display: none">    <i class="fas fa-spinner fa-pulse fa-4x"></i></div>'};return n[t.form]=t,t},s=function(r,t,e){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if($(r).length&&$(t).length){var o=new i(r);$(t).on("hide.bs.modal",(function(r){o.clearInputs(),n&&o.destroy(),o.errorsObj&&o.errorsObj.clearErrors()})),o.onSubmit((function(r,n){n.done((function(n){r.clearInputs(),a({title:n.msg.title,text:n.msg.msg,icon:"success"}),$(t).modal("hide"),window.BaseAdmin.ajaxLoadWrappers(e)}))}))}},a=function(r){e.e(455).then(e.t.bind(e,6455,23)).then((function(t){t.default.fire({title:r.title?r.title:"Error!",text:r.text,timer:15e3,icon:r.icon,timerProgressBar:!0})}))}}}]);